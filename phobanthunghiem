<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kayako ‚Äì Ph√≥ b·∫£n th·ª© ba</title>
<style>
  body {
    background-color: #000;
    color: #eee;
    font-family: 'Courier New', monospace;
    padding: 20px;
    line-height: 1.6;
  }
  #game {
    max-width: 650px;
    margin: auto;
    background: rgba(20,20,20,0.85);
    padding: 25px;
    border-radius: 10px;
    box-shadow: 0 0 20px #111;
  }
  button {
    display: block;
    width: 100%;
    margin: 8px 0;
    padding: 10px;
    background: #111;
    color: #fff;
    border: 1px solid #555;
    border-radius: 5px;
    cursor: pointer;
    transition: 0.3s;
  }
  button:hover {
    background: #222;
    border-color: crimson;
    color: crimson;
  }
  .dead { color: crimson; }
  .safe { color: lightgreen; }
  h2 { text-align: center; color: crimson; }
</style>
</head>
<body>
<div id="game">
  <h2>üìú Kayako ‚Äì Ph√≥ b·∫£n th·ª© ba</h2>
  <div id="story"></div>
  <div id="choices"></div>
</div>

<script>
let inventory = { dao: false, manhMoi: false, nhatKi: false, khoa: false };
let alive = true;

// typing effect
function typeText(element, text, callback) {
  let i = 0;
  element.innerHTML = "";
  function typing() {
    if (i < text.length) {
      element.innerHTML += text.charAt(i);
      i++;
      setTimeout(typing, 15);
    } else if (callback) callback();
  }
  typing();
}

function show(text, choices=[]) {
  const storyDiv = document.getElementById('story');
  const choiceDiv = document.getElementById('choices');
  choiceDiv.innerHTML = '';
  typeText(storyDiv, text, () => {
    for (let c of choices) {
      const btn = document.createElement('button');
      btn.textContent = c.text;
      btn.onclick = c.action;
      choiceDiv.appendChild(btn);
    }
  });
}

// --- M·ªû ƒê·∫¶U ---
function start() {
  inventory = { dao: false, manhMoi: false, nhatKi: false, khoa: false };
  alive = true;
  show(`
  <p>B·∫°n c√πng nh√≥m h·ªçc sinh m·∫°o hi·ªÉm ƒë·∫øn cƒÉn nh√† b·ªè hoang theo l√° th∆∞ n·∫∑c danh...</p>
  <p>ƒêi·ªán tho·∫°i m·∫•t s√≥ng. C√°nh c·ª≠a ƒë√≥ng s·∫ßm l·∫°i ph√≠a sau.</p>
  <p><b>Nhi·ªám v·ª•:</b> T√¨m ƒë∆∞·ª£c C·ª¨A v√† CH√åA ƒë·ªÉ tho√°t ra kh·ªèi n∆°i n√†y.</p>
  `, [
    { text: "B·∫Øt ƒë·∫ßu kh√°m ph√°", action: map }
  ]);
}

// --- B·∫¢N ƒê·ªí ---
function map() {
  show(`<p>B·∫°n ƒëang ·ªü s·∫£nh ch√≠nh. B·∫°n mu·ªën ƒëi ƒë√¢u?</p>`, [
    { text: "1. Ph√≤ng kh√°ch", action: phongKhach },
    { text: "2. Ph√≤ng Kayako", action: phongKayako },
    { text: "3. Ph√≤ng con trai Kayako", action: phongCon },
    { text: "4. Ph√≤ng t·∫Øm", action: phongTam },
    { text: "5. G√°c m√°i", action: gacMai },
    { text: "6. B·∫øp", action: bep },
    { text: "7. Ph√≤ng ch·ªìng Kayako", action: phongChong },
  ]);
}

// --- I. PH√íNG KH√ÅCH ---
function phongKhach() {
  show(`<p>Ph√≤ng kh√°ch c≈© k·ªπ, n·ªÅn nh√† ƒë·∫ßy m·∫£nh b√¨nh hoa v·ª°. C·ª≠a d√≠nh m√°u b·ªã kh√≥a.</p>`, [
    { text: "1. Ti·∫øn ƒë·∫øn xem c√°nh c·ª≠a", action: () => {
      inventory.manhMoi = true;
      show(`<p class="safe">B·∫°n ƒë√£ t√¨m th·∫•y <b>C·ª¨A</b>! H√£y t√¨m ch√¨a kh√≥a ƒë·ªÉ tho√°t.</p>`, [
        { text: "Tr·ªü l·∫°i b·∫£n ƒë·ªì", action: map }
      ]);
    }},
    { text: "2. Nh·∫∑t m·∫£nh v·ª° ph√≤ng th√¢n", action: () => {
      death("Trong l√∫c nh·∫∑t, b·∫°n b·ªã ƒë·ª©t tay. M√°u r∆°i xu·ªëng s√†n... Kayako ƒë√°nh h∆°i ƒë∆∞·ª£c v√† b·∫ª c·ªï b·∫°n!");
    }},
    { text: "3. ƒêi xung quanh xem x√©t", action: () => {
      show(`<p class="safe">B·∫°n ƒëi quanh ph√≤ng, nh∆∞ng kh√¥ng ph√°t hi·ªán g√¨ th√™m.</p>`, [
        { text: "Tr·ªü l·∫°i b·∫£n ƒë·ªì", action: map }
      ]);
    }}
  ]);
}

// --- II. PH√íNG KAYAKO ---
function phongKayako() {
  show(`<p>Ph√≤ng ng·ªß c·ªßa Kayako ƒë·∫ßy b·ª•i v√† ·∫©m m·ªëc, c√≥ b√†n v√† gi∆∞·ªùng c≈©.</p>`, [
    { text: "1. L√™n gi∆∞·ªùng ngh·ªâ ng∆°i", action: () => {
      death("Kayako t·ª©c gi·∫≠n v·ªõi s·ª± thi·∫øu l·ªãch s·ª± c·ªßa b·∫°n. C√¥ ta v·ªì t·ªõi v√† b·∫ª c·ªï b·∫°n!");
    }},
    { text: "2. ƒê·∫øn b√†n xem x√©t", action: () => {
      show(`<p>Tr√™n b√†n c√≥ <b>con dao</b> v√† <b>cu·ªën nh·∫≠t k√≠</b>.</p>`, [
        { text: "a) L·∫•y dao", action: () => {
          inventory.dao = true;
          show(`<p class="safe">B·∫°n ƒë√£ c√≥ dao.</p>`, [{ text: "Tr·ªü l·∫°i b·∫£n ƒë·ªì", action: map }]);
        }},
        { text: "b) Xem nh·∫≠t k√≠", action: xemNhatKi },
      ]);
    }},
    { text: "3. Ra kh·ªèi ph√≤ng", action: map }
  ]);
}

// --- NH·∫¨T K√ç ---
function xemNhatKi() {
  inventory.nhatKi = true;
  show(`<p>Nh·∫≠t k√≠ c√≥ 15 trang. B·∫°n ch·ªâ m·ªü ƒë∆∞·ª£c 2 trang. M·ªü trang n√†o?</p>`, [
    { text: "Trang 4", action: () => {
      show(`<p class="safe">"T·ªß tr√™n g√°c m√°i c√≥ g√¨ ƒë√≥..."</p>`, [
        { text: "Tr·ªü l·∫°i b·∫£n ƒë·ªì", action: map }
      ]);
    }},
    { text: "Trang 13", action: () => {
      inventory.khoa = true;
      show(`<p class="safe">B·∫°n t√¨m th·∫•y <b>CH√åA KH√ìA!</b></p>`, [
        { text: "Tr·ªü l·∫°i ph√≤ng kh√°ch", action: thoat }
      ]);
    }},
    { text: "Trang 1", action: () => death("Ch·ªØ 'CH·∫æT' ƒë∆∞·ª£c vi·∫øt b·∫±ng m√°u. B·∫°n d√≠nh m√°u v√† Kayako gi·∫øt ch·∫øt b·∫°n.") },
  ]);
}

// --- III. PH√íNG CON TRAI ---
function phongCon() {
  show(`<p>Ph√≤ng c·ªßa Toshio l·∫°nh l·∫Ωo, c√≥ th·ª© g√¨ ƒë√≥ l·∫•p l√°nh b√™n trong...</p>`, [
    { text: "1. V√†o trong", action: () => {
      inventory.dao = true;
      show(`<p class="safe">B·∫°n t√¨m th·∫•y m·ªôt con dao nh·ªè.</p>`, [
        { text: "Tr·ªü l·∫°i b·∫£n ƒë·ªì", action: map }
      ]);
    }},
    { text: "2. Tr·ªü v·ªÅ", action: map }
  ]);
}

// --- IV. PH√íNG T·∫ÆM ---
function phongTam() {
  show(`<p>B·∫°n th·∫•y n∆∞·ªõc m√°y tr√¥ng r·∫•t s·∫°ch, c√≥ mu·ªën t·∫Øm kh√¥ng?</p>`, [
    { text: "1. C√≥", action: () => death("Khi b·∫°n t·∫Øm, Toshio tr·ªìi l√™n t·ª´ m·∫∑t n∆∞·ªõc v√† d√¨m b·∫°n ch·∫øt ƒëu·ªëi.") },
    { text: "2. Kh√¥ng", action: () => {
      show(`<p class="safe">B·∫°n an to√†n r·ªùi kh·ªèi ph√≤ng t·∫Øm.</p>`, [
        { text: "Tr·ªü l·∫°i b·∫£n ƒë·ªì", action: map }
      ]);
    }}
  ]);
}

// --- V. G√ÅC M√ÅI ---
function gacMai() {
  show(`<p>G√°c m√°i l·∫°nh l·∫Ωo, c√≥ m·ªôt c√°i t·ªß c≈©.</p>`, [
    { text: "1. M·ªü t·ªß xem", action: () => {
      inventory.manhMoi = true;
      show(`<p class="safe">B·∫°n nh·∫≠n ƒë∆∞·ª£c manh m·ªëi: "Ch√¨a kh√≥a n·∫±m trong nh·∫≠t k√≠."</p>`, [
        { text: "Tr·ªü l·∫°i b·∫£n ƒë·ªì", action: map }
      ]);
    }},
    { text: "2. Kh√¥ng xem", action: map }
  ]);
}

// --- VI. B·∫æP ---
function bep() {
  show(`<p>B·∫°n th·∫•y con dao d√≠nh m√°u tr√™n b√†n b·∫øp.</p>`, [
    { text: "1. L·∫•y dao", action: () => death("B·∫°n d√≠nh m√°u! Kayako ƒë√°nh h∆°i ƒë∆∞·ª£c v√† gi·∫øt b·∫°n.") },
    { text: "2. Kh√¥ng l·∫•y", action: () => {
      show(`<p class="safe">B·∫°n an to√†n r·ªùi kh·ªèi b·∫øp.</p>`, [
        { text: "Tr·ªü l·∫°i b·∫£n ƒë·ªì", action: map }
      ]);
    }}
  ]);
}

// --- VII. PH√íNG CH·ªíNG ---
function phongChong() {
  show(`<p>Ph√≤ng l·∫°nh v√† t·ªëi. B·∫≠t ƒë√®n flash ƒë·ªÉ v√†o ch·ª©?</p>`, [
    { text: "1. C√≥", action: () => death("C·ª≠a ƒë√≥ng l·∫°i, ƒëi·ªán tho·∫°i t·∫Øt ngu·ªìn. Ch·ªìng Kayako t√∫m l·∫•y v√† x√© x√°c b·∫°n.") },
    { text: "2. Kh√¥ng", action: map }
  ]);
}

// --- THO√ÅT ---
function thoat() {
  if (inventory.khoa && inventory.manhMoi) {
    show(`<p class="safe">B·∫°n d√πng ch√¨a kh√≥a m·ªü c·ª≠a. √Ånh s√°ng tr√†n v√†o...</p>
    <h3 class="safe">üéâ CH√öC M·ª™NG! B·∫†N ƒê√É THO√ÅT KH·ªéI L·ªúI NGUY·ªÄN KAYAKO!</h3>`, [
      { text: "Ch∆°i l·∫°i", action: start }
    ]);
  } else {
    show(`<p>C·ª≠a b·ªã kh√≥a, b·∫°n v·∫´n ch∆∞a c√≥ ƒë·ªß manh m·ªëi.</p>`, [
      { text: "Tr·ªü l·∫°i b·∫£n ƒë·ªì", action: map }
    ]);
  }
}

// --- CH·∫æT ---
function death(msg) {
  alive = false;
  show(`<p class="dead">${msg}</p><h3 class="dead">üíÄ B·∫†N ƒê√É CH·∫æT</h3>`, [
    { text: "Ch∆°i l·∫°i", action: start }
  ]);
}

start();
</script>
</body>
</html>
